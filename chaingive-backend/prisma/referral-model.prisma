// Add this to the main schema.prisma file

model Referral {
  id              String    @id @default(uuid())
  referrerId      String    @map("referrer_id")
  referredUserId  String    @map("referred_user_id")
  referralCode    String    @map("referral_code")
  status          String    @default("pending") @map("status") // pending, registered, first_cycle, completed
  coinsEarned     Int       @default(0) @map("coins_earned")
  registeredAt    DateTime? @map("registered_at")
  firstCycleAt    DateTime? @map("first_cycle_at")
  completedAt     DateTime? @map("completed_at")
  createdAt       DateTime  @default(now()) @map("created_at")

  // Relations
  referrer     User @relation("Referrer", fields: [referrerId], references: [id])
  referredUser User @relation("Referred", fields: [referredUserId], references: [id])

  @@unique([referrerId, referredUserId])
  @@index([referrerId])
  @@index([referredUserId])
  @@index([referralCode])
  @@index([status])
  @@map("referrals")
}
